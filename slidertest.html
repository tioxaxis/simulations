<!DOCTYPE html>

<html>

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="./app/res/tiox3.png">
	<link rel="stylesheet" type="text/css" href="./app/app.css">

	<!--software for random number generation-->
	<script src='./app/res/jstat.min.js'></script>
	
	<!-- converts Math.random() to be seeded    -->
	<script src='/app/res/seedrandom.min.js'></script>

<!--	<script type='module' src='./app/app.js'></script>-->
    <style>
    .crossOut{
        text-decoration-line: line-through;
        }
    </style>
</head>
<body>
    <div id='place' style='width: 20%'>
    
    </div>
    
    
</body>
<script type='module'>
    import {
         genRange,  htmlNumSlider, NumSlider,
                    htmlArbSlider, ArbSlider,
        genCheckBox, htmlCheckBox, CheckBox,
        genRadio , htmlRadioButton, RadioButton ,
        IntegerInput, 
        LegendItem
          
    }
    from "./app/mod/genHTML.js";
//    function numSpecifics(){
//        console.log('called the num specifics routines value is',NumSlider.get());
//    };
//    function arbSpecifics(){
//        console.log('called the arb specifics routines value is',ArbSlider.get());
//    };
    
//    function rbSpecifics(){
//        console.log('called the rb specifics routines value is',rb.get());
//    };
//    
//    function cbSpecifics(){
//        console.log('called the cb specifics routines value is',cb.get());
//    };
    
    let spRoutines ={}
    
    let place = document.getElementById('place');
    
    let numInput = genRange('numid','6.0',5, 9, 1);
    let numSliderBox = htmlNumSlider(numInput,
                        'Numeric Range = ', '6.0', [5, 7, 9] );
    let numRngObj = new NumSlider('num', numInput, localRoutine,1,2,10);
    place.append(numSliderBox);
    

    let arbInput = genRange('arbid',0 ,0, 4, 1);
    let arbSliderBox = htmlArbSlider(arbInput,
                        'Arbitrary Range = ', 'A' 
                        , ['A','C','E']  );
    let arbRngObj = new ArbSlider(arbInput, localRoutine,
                                 ['A','B','C','D','E'], ['a','b','c','d','e']);
    place.append(arbSliderBox);
        
    spRoutines['numid']=numRngObj;
    
//    let ArbSlider = new ArbSlider('arbid',arbSpecifics,
//                                ['A','B','C','D','E'],
//                               ['a','b','c','d','e']);
//    spRoutines['arbid'] = ArbSlider;
    
//    let numHTML = numRngObj.htmlNumSlider('Numeric Range =',6, [5, 7,9]   );
//    let arbHTML = ArbSlider.htmlArbSlider('Arbitrary Range =',1,['A','C','E']   );
    
//    place.append(numSliderBox);
    console.log(numRngObj.get());
    console.log(arbRngObj.get());
    console.log(arbRngObj.getValue());
    
    numRngObj.set(9);
    arbRngObj.set(4);
    console.log(numRngObj.get());
    console.log(arbRngObj.get());
    console.log(arbRngObj.getValue());
    function localRoutine(key){
        console.log('reached local rountine with key=>'+key+'<=')
    }
    
    let cbInput = genCheckBox('cbid');
    let cbElem = htmlCheckBox(cbInput,'here is a checkbox');
    let cb = new CheckBox('cb', cbInput, localRoutine );
    place.append(cbElem);
    console.log(' cb=', cb.get() );
    
    
    
//    spRoutines['action'] = rb;
    place.append(
    htmlRadioButton('action','play','play',true,'PlayLabel'),
    htmlRadioButton('action','pause','pause',false,'PauseLabel'),
    htmlRadioButton('action','none','none',false,'NoneLabel')
    );
    let rb = new RadioButton('action',localRoutine, ["none","play","pause"]);
    
    rb.set('pause');
    console.log('radio button output',rb.get()+'>'+rb.encode(rb.get())+'<');
    
    rb.set('none');
    console.log('radio button output',rb.get()+'>'+rb.encode(rb.get())+'<');
    
    
    let intRange = genRange('intid', 4, 2, 12, 2);
    let intInput = new IntegerInput(intRange, localRoutine, 2);
    place.append('here is a integer box',intRange);
    
    
//    place.addEventListener('input', captureUserUpdate);
    
    function captureUserUpdate(){
        let inputElem = event.target.closest('input');
        if (!inputElem) return;
        let id = event.target.id;
        let v = inputElem.value;
        let t = inputElem.type;
        let name = inputElem.name;
        console.log('clicked on id=',id,'name=',name,'value=',v);
        spRoutines
        switch (t){
            case 'range':
            case  'checkbox':
                spRoutines[id].userUpdate();
                break;
            case 'radio':
                spRoutines[name].userUpdate();
                break;
        }
    
        };
    
    
    
    class LegendDomElem{
        constructor(id, isAnAverage, color){
            this.id = id;
            this.visible = true;
            this.elem = null;
            this.isAnAverage = isAnAverage;
            this.color = color;
            this.name = document.createElement('span');
            // text filled in with next routine.
        };
        createHTML(nametext){
            const rB = document.createElement('i');
            rB.classList.add('material-icons');
            rB.classList.add('actButton');
            rB.classList.add('font15vw');
            rB.title = 'reset the average';
            rB.innerHTML = 'replay';
            const dot = document.createElement('span');
            dot.innerHTML = '&#11044;&nbsp;'
            dot.style = 'color:'+this.color;
            
            this.name.innerHTML = nametext;
            
            this.elem = document.getElementById(this.id);
            if( !this.elem ){
                this.elem = document.createElement('div');
                this.elem.id = this.id;   
            }
            
            
            
            this.elem.append((this.isAnAverage ? rB : ''),dot, this.name);
            
            rB.addEventListener('click',this.resetAverage.bind(this));
            return this.elem;
        };
        setVisibility(b){
            this.visible = b;
            if( this.visible )
                this.name.classList.remove('crossOut');
            else
              this.name.classList.add('crossOut');  
        };
//        makeVisible(){
//            this.visible = true;
//            this.name.classList.remove('crossOut');
//        };
//        makeInvisible(){
//            this.visible = false;
//            this.name.classList.add('crossOut');
//        };
        toggleVisible(){
            if( this.visible ){
                this.name.classList.add('crossOut');
                this.visible = false;
            } else {
                this.name.classList.remove('crossOut');
                this.visible = true;
            }
            console.log('Visible',this.visible);
        };
        resetAverage(){
            console.log('clicked on the reset average button');
        }
        
        
            
    };
    
    const testL = new LegendDomElem('test', true, 'green');
    const test2 = new LegendDomElem('test2',false, 'blue');
    let x = document.getElementById('test2');
    
    
    place.append(testL.createHTML('Average Cost'),test2.createHTML('2nd Legend'));
    
    
    let testLobj = new LegendItem(testL,localRoutine);
    let test2obj = new LegendItem(test2,localRoutine);
    
    console.log('legend 1 ',testLobj.get()+'>'+testLobj.encode(testLobj.get())+'<');
    testL.setVisibility(false);
    console.log('legend 1 ',testLobj.get()+'>'+testLobj.encode(testLobj.get())+'<');
    testL.setVisibility(true);
    console.log('legend 1 ',testLobj.get()+'>'+testLobj.encode(testLobj.get())+'<');
    testLobj.set('false');
    console.log('legend 1 ',testLobj.get()+'>'+testLobj.encode(testLobj.get())+'<');
    testLobj.set('true');
    console.log('legend 1 ',testLobj.get()+'>'+testLobj.encode(testLobj.get())+'<');
    
    
    
    </script>
</html>
