<!DOCTYPE html>

<html>

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="./app/res/tiox3.png">
	<link rel="stylesheet" type="text/css" href="./app/app.css">

	<!--software for random number generation-->
	<script src='./app/res/jstat.min.js'></script>
	
	<!-- converts Math.random() to be seeded    -->
	<script src='/app/res/seedrandom.min.js'></script>

<!--	<script type='module' src='./app/app.js'></script>-->
    <style>
    .crossOut{
        text-decoration-line: line-through;
        }
    </style>
</head>
<body>
    <div id='place' style='width: 20%'>
    
    </div>
    
    
</body>
<script type='module'>
    import {
         NumRange,  ArbRange, genRange, CheckBox,  RadioButton  
    }
    from "./app/mod/genHTML.js";
    function numSpecifics(){
        console.log('called the num specifics routines value is',numRange.get());
    };
    function arbSpecifics(){
        console.log('called the arb specifics routines value is',arbRange.get());
    };
    
    function rbSpecifics(){
        console.log('called the rb specifics routines value is',rb.get());
    };
    
    function cbSpecifics(){
        console.log('called the cb specifics routines value is',cb.get());
    };
    
    let spRoutines ={}
    
    let place = document.getElementById('place');
    
    let numRange = new NumRange('numid',numSpecifics,1,5,9,.5);
    spRoutines['numid']=numRange;
    
    let arbRange = new ArbRange('arbid',arbSpecifics,
                                ['A','B','C','D','E'],
                               ['a','b','c','d','e']);
    spRoutines['arbid'] = arbRange;
    
    let numHTML = numRange.htmlNumSlider('Numeric Range =',6, [5, 7,9]   );
    let arbHTML = arbRange.htmlArbSlider('Arbitrary Range =',1,['A','C','E']   );
    
    place.append(numHTML,arbHTML);
    console.log(numRange.get());
    console.log(arbRange.get());
    numRange.set(9);
    arbRange.set(4);
    console.log(numRange.get());
    console.log(arbRange.get());
    
    
    let rb = new RadioButton('action',rbSpecifics,["none","play","pause"]);
    spRoutines['action'] = rb;
    place.append(
    rb.htmlRadioButton('play','play',true,'PlayLabel'),
    rb.htmlRadioButton('pause','pause',false,'PauseLabel'),
    rb.htmlRadioButton('none','none',false,'NoneLabel'));
    
    
    let cb = new CheckBox('ch',cbSpecifics);
    spRoutines['ch'] = cb;
    
    let checkHTML = cb.htmlCheckBox('here is a checkbox');
    place.append(checkHTML);
    console.log('rb and cb=',rb.get(),cb.get() );
    
    place.addEventListener('input', captureUserUpdate);
    
    function captureUserUpdate(){
        let inputElem = event.target.closest('input');
        if (!inputElem) return;
        let id = event.target.id;
        let v = inputElem.value;
        let t = inputElem.type;
        let name = inputElem.name;
        console.log('clicked on id=',id,'name=',name,'value=',v);
        spRoutines
        switch (t){
            case 'range':
            case  'checkbox':
                spRoutines[id].userUpdate();
                break;
            case 'radio':
                spRoutines[name].userUpdate();
                break;
        }
    
        };
    
    
    
    class LegendElem{
        constructor(id, isAnAverage, color){
            this.id = id;
            this.visible = true;
            this.elem = null;
            this.isAnAverage = isAnAverage;
            this.color = color;
        };
        createHTML(nametext){
            const rB = document.createElement('i');
            rB.classList.add('material-icons');
            rB.classList.add('actButton');
            rB.classList.add('font15vw');
            rB.title = 'reset the average';
            rB.innerHTML = 'replay';
            const dot = document.createElement('span');
            dot.innerHTML = '&#11044;&nbsp;'
            dot.style = 'color:'+this.color;
            this.name = document.createElement('span');
            this.name.innerHTML = nametext;
            
            
            
            
            this.elem = document.createElement('div');
            this.elem.id = this.id;
            this.elem.append((this.isAnAverage ? rB : ''),dot, this.name);
            this.name.addEventListener('click', this.toggleVisible.bind(this));
            rB.addEventListener('click',this.resetAverage.bind(this));
            return this.elem;
        };
        setVisibility(b){
            this.visible = b == 'true';
            if( this.visible )
                this.name.classList.remove('crossOut');
            else
              this.name.classList.add('crossOut');  
        };
//        makeVisible(){
//            this.visible = true;
//            this.name.classList.remove('crossOut');
//        };
//        makeInvisible(){
//            this.visible = false;
//            this.name.classList.add('crossOut');
//        };
        toggleVisible(){
            if( this.visible ){
                this.name.classList.add('crossOut');
                this.visible = false;
            } else {
                this.name.classList.remove('crossOut');
                this.visible = true;
            }
            console.log('Visible',this.visible);
        };
        resetAverage(){
            console.log('clicked on the reset average button');
        }
        
        
            
    };
    
    const testL = new LegendElem('test', true, 'green');
    const test2 = new LegendElem('test2',false, 'blue')
    
    place.append(testL.createHTML('Average Cost'),test2.createHTML('2nd Legend'));
    
    
    
    
    
    
    
    </script>
</html>
